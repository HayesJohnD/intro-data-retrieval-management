---
title: '[Optional] Introduction to Computational Thinking & Simulation with R'
author: Christopher Gandrud
date: '2021-03-11'
slug: optional-r-basics-3
weight: 4
categories:
  - R
  - install
tags: [R, simulation, distributed, functions]
Categories: []
Description: ''
Tags: [R, simulation, distributed, functions]
bibliography: main.bib
---

> "What I cannot create, I do not understand" -- [Richard Feynman](https://archives.caltech.edu/pictures/1.10-29.jpg)

> "It is immoral to collect data before simulating the hypothesized data generating process." -- Andrew Gelman (what I remember of a comment to the Stanford Causal Inference Seminar in 2020)

```{r}
# Load required packages
xfun::pkg_attach2("DiagrammeR")
```

## 📝 Lesson Preview

-   [Why simulate?](#motivation)

-   [Simple simulation workflow](#workflow)

-   [Debugging in R](debugging-intro)

## Motivation: Why simulate? {#motivation}

We've covered many of the basics of programming in R. Let's bring many of these concepts together to help us better understand our research problems, even before we gather any data. Let's simulate some **data generating processes (DGP)**.

A data generating process is the process that creates the data in a data set. These processes can include, for example, both the social processes that result in migration data and even unexpected (or undesired) issues in the sampling procedure like non-random study attrition.

Wait, why are we talking about simulating data generating processes in an introduction to R course? There are two sets of reasons.

First, computational generative modeling--simulating data generating processes with a computer--can be a key tool for @gelmanhillaki2021

[TO COMPLETE]

## Simple simulation workflow {#workflow}

A typical simulation workflow looks something like this:

```{r sim-workflow, echo=FALSE}
DiagrammeR::mermaid("
graph TB
  A[Hypothesise DGP]-->B[Functions for 1 draw/analysis]
  B-->C[Function for n draws]
  B-- Debug -->B
  C-->D[Plot simulations]
  C-- Debug -->C 
  D-- Debug -->D
  D-- Iterate -->A
")
```

### Example 1: Simple A/B Test Discrete probabilities

## Debugging in R {#debugging-intro}

Debugging is the process of finding and resolving discrepancies between a program's specification and its implementation. For example, I want a ggplot2 to plot multiple time series on the same plot as separate lines, but it plots them all as one--very jagged and confusing line. I use a debugging process to find the cause of and correct this discrepancy.

The reason we are covering debugging now, is that statistical simulations are more complex processes and debugging them is more complicated and crucial.

[![](https://upload.wikimedia.org/wikipedia/commons/f/ff/First_Computer_Bug%252C_1945.jpg "An actual computer bug (source Wikipedia)")](https://en.wikipedia.org/wiki/Debugging)

### Being mindful of your feelings

We'll cover the the technical debugging tools available in R. But I first want to first mention a crucial part of effective (and less stressful) debugging: *being mindful of your feelings about the bug*.

A bug is frustrating because we are experiencing an, initially unclear, disassociation between who we think the world should work and how it is working. It's as if we want to put a plate in the cupboard, but each time we try this it flies out. Frustration inclines us to look for the cause of a bug in--almost always--the wrong place: "the stupid computer is broken".

The best way to resolve bugs, as we'll see, is to create testable hypotheses about what could be causing the bug. "The stupid computer is broken" is vague and so not a testable hypothesis.

So, it is crucial that when you find a bug, to take a step back and ask:

> how does this bug make me feel?

If the answer is "angry, I want to throw my computer out the window", your best next step is to *take a break*. Grab a tea or whatever. Then, with a piece of paper (or some other tool that gets you away from the temptation to just begin slamming out code on your keyboard) write down hypotheses about the cause of the bug and ways to test these.

Unlike social phenomena, most computer bugs are deterministic. The cause of a bug will always cause the bug. So your chances of definitively finding the bug are high with the following process and tools.

### Clear, testable program specifications 

### Tools for testing and dissecting

The `browser()` function is critical for debugging functions and loops in R. When R is executing some code and hits `browser()` it stops the execution and begins an interactive `Browse` mode. This allows you to explore the objects in the current environment and run code. RStudio works really well with this function.
